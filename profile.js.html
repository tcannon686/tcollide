<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: profile.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: profile.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* eslint-env browser */

function rollingMean () {
  let count = 0
  let mean = 0

  function add (value) {
    mean = mean * count / (count + 1)
    count++
    mean += value / count
  }

  return {
    add,
    mean: () => mean
  }
}

function stopwatch () {
  let time
  return {
    start () {
      time = performance.now()
    },
    stop () {
      const elapsed = performance.now() - time
      return elapsed
    }
  }
}

function meanStopwatch () {
  const average = rollingMean()
  const watch = stopwatch()
  return {
    start () {
      watch.start()
    },
    stop () {
      average.add(watch.stop())
      return average.mean()
    },
    mean () {
      return average.mean()
    }
  }
}

function makeProfiler () {
  const data = {
    gjkStopwatch: meanStopwatch(),
    epaStopwatch: meanStopwatch(),
    getOverlapStopwatch: meanStopwatch(),
    supportStopwatch: meanStopwatch(),
    updateStopwatch: meanStopwatch(),
    treeGenerateStopwatch: meanStopwatch(),
    quickselectStopwatch: meanStopwatch(),
    gjkIterations: rollingMean(),
    epaIterations: rollingMean(),
    treeHeight: rollingMean(),
    nearestSimplexStopwatch: meanStopwatch()
  }
  return {
    data,
    gist () {
      return (
        Object.entries(data)
          .map(([name, value]) => 'average ' + name + ': ' + value.mean())
          .join('\n')
      )
    }
  }
}

let profilerSingleton = null
/**
 * Returns the profiler currently in use, or null if none have been created.
 *
 * @returns {Profiler}
 */
export function profiler () {
  return profilerSingleton
}

/**
 * @property {Function} gist - Return a human readable string about the profile
 * @typedef Profiler
 */

/**
 * Create a profiler, to be accessed by profiler()
 */
export function createProfiler () {
  profilerSingleton = makeProfiler()
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#beginOverlap">beginOverlap</a></li><li><a href="global.html#body">body</a></li><li><a href="global.html#bodyOf">bodyOf</a></li><li><a href="global.html#box">box</a></li><li><a href="global.html#changed">changed</a></li><li><a href="global.html#circle">circle</a></li><li><a href="global.html#collisionScene">collisionScene</a></li><li><a href="global.html#createProfiler">createProfiler</a></li><li><a href="global.html#endOverlap">endOverlap</a></li><li><a href="global.html#hull">hull</a></li><li><a href="global.html#overlap">overlap</a></li><li><a href="global.html#point">point</a></li><li><a href="global.html#profiler">profiler</a></li><li><a href="global.html#scene">scene</a></li><li><a href="global.html#sphere">sphere</a></li><li><a href="global.html#split">split</a></li><li><a href="global.html#stayOverlap">stayOverlap</a></li><li><a href="global.html#sum">sum</a></li><li><a href="global.html#transformable">transformable</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sat Nov 13 2021 15:35:34 GMT-0800 (Pacific Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
